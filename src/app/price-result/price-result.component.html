<div class="grid" (click)="openModal()" (contextmenu)="onRightClick($event)">
    <div class="title">
        {{name()}}
    </div>
    
    @if (marketPriceDc() > 0) {
        <div class="dc-price">
            {{result().dc}} Price: {{marketPriceDc() | number : '1.0-2'}}
        </div>
        <div class="world-price">
            {{result().world}} Price: {{marketPriceWorld() | number : '1.0-2'}}
        </div>
        <div class="dc-gil">
            {{result().dc}}: {{marketThroughputDc() | number : '1.0-2'}} G/wk
        </div>
        <div class="world-gil">
            {{result().world}}: {{marketThroughputWorld() | number : '1.0-2'}} G/wk
        </div>
        <div class="units">
            {{result().hqSaleVelocity | number : '1.0-2'}}HQ {{result().nqSaleVelocity | number : '1.0-2'}}NQ S/wk
        </div>
        
        @if (sortCrafted()) {
            @if (cheapestCraftPrice() < 999999) {
                <div class="cost">
                    Crafted Cost: {{cheapestCraftPrice() | number : '1.0-2'}}
                </div>
                <div class="profit">
                    Craft profit: {{craftProfit() | number : '1.0-2'}}
                </div>
            } @else {
                <div class="invalid">
                    Item not craftable
                </div>
            }
        }
        @if (!sortCrafted()) {
            @if ((shopPrice() ?? 1000000) < 999999) {
                <div class="cost">
                    Shop Cost: {{shopPrice() | number : '1.0-2'}}
                </div>
                <div class="profit">
                    Shop profit: {{shopProfit() | number : '1.0-2'}}
                </div>
            } @else {
                <div class="invalid">
                    Item not purchasable
                </div>
            }
        }
    } @else if (marketPriceDc() < 0) {
        <span class="none-sold">None sold in last week</span>
    } @else {
        <span class="loader"></span>
    }
</div>

<dialog #dialog class="modal">
    <app-price-result-tree [result]="result()" [depth]="0"></app-price-result-tree>
    <button mat-flat-button color="primary" class="close-button" (click)="closeModal()">Close</button>
</dialog>